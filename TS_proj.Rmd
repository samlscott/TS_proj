---
title: 'Replication: Identifying Aggregate Supply and Demand Shocks in South Africa'
documentclass: elsarticle
Thesis_FP: no
output:
  pdf_document:
    keep_tex: yes
    template: Tex/TexDefault.txt
    fig_width: 3.5
    fig_height: 3.5
  html_document:
    df_print: paged
Author1: Samantha Scott
Ref1: Stellenbosch University, Cape Town, South Africa
Email1: 20945043\@sun.ac.za
CorrespAuthor_1: yes
keywords: Econometrics \sep Time Series \sep VAR \sep Blanchard-Quah
BottomRFooter: \footnotesize Page \thepage
addtoprule: yes
addfootrule: yes
margin: 2.3
bottom: 2
top: 2.5
HardSet_layout: yes
linenumbers: no
bibliography: Tex/ref.bib
csl: Tex/harvard-stellenbosch-university.csl
RemovePreprintSubmittedTo: yes
Journal: Journal of Finance
toc: no
numbersections: yes
fontsize: 11pt
linestretch: 1.2
link-citations: yes
AddTitle: yes
#always_allow_html: true
---

<!-- First: Set your default preferences for chunk options: -->

<!-- If you want a chunk's code to be printed, set echo = TRUE. message = FALSE stops R printing ugly package loading details in your final paper too. I also suggest setting warning = FALSE and checking for warnings in R, else you might find ugly warnings in your paper. -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
# Note: Include = FALSE implies the code is executed, but not printed in your pdf.
# warning and message = FALSE implies ugly messages and warnings are removed from your pdf.
# These should be picked up when you execute the command chunks (code sections below) in your rmd, not printed in your paper!

# Lets load in example data, and see how this can be stored and later called from your 'data' folder.
if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
Example_data <- Texevier::Ex_Dat

# Notice that as you are working in a .Rproj file (I am assuming you are) - the relative paths of your directories start at your specified root.
# This means that when working in a .Rproj file, you never need to use getwd() - it is assumed as your base root automatically.
write_rds(Example_data, path = "data/Example_data.rds")

```

<!-- ############################## -->

<!-- # Start Writing here: -->

<!-- ############################## -->

```{r}
# load packages
library(urca)
library(vars)
library(tseries)
library(TSstudio)
library(forecast)
library(tidyverse)
```

```{r}
# importing data
library(readr)
gdp <- read_csv("/Users/samanthascott/Desktop/TS_proj/new_data/FRED/gdp.csv")
price_deflator <- read_csv("/Users/samanthascott/Desktop/TS_proj/new_data/FRED/price_deflator.csv")
g_g_not_s <- read_csv("/Users/samanthascott/Desktop/TS_proj/new_data/FRED/g_g_not_s.csv")
Real_interest <- read_csv("/Users/samanthascott/Desktop/TS_proj/new_data/FRED/Real_interest.csv")
```

```{r}
gdp1 <- gdp[1:188,]
```

```{r}
Real_interest1 <- Real_interest[1:188,]
```

```{r}
price_deflator1 <- price_deflator[1:188,]
```


# Introduction

The paper, *Identifying aggregate supply and demand shocks in South Africa*, is an application of a structural VAR method to identify supply and demand shocks for the South African economy since the 1960s. 

```{r}
# creating real_gdp df
real_gdp <- gdp1$ZAFGDPNQDSMEI/price_deflator1$ZAFGDPDEFQISMEI
realgdp <- as.data.frame(real_gdp)
```

```{r}
# first diff of the log of real gdp (change in yt)
y_t1 <- log(realgdp)

# Calculate the first difference of AirPass using lag and subtraction
diff_by_hand <- y_t1$real_gdp - lag(y_t1$real_gdp)
real_gdp1 <- as.data.frame(diff_by_hand) # this is the change in y_t
real_gdp1 <- real_gdp1[-1,]
```


```{r}

y_t <- ts(real_gdp1, start (1960,2))
g_t <- ts(g_g_not_s$Value, start (1960,2))
r_t <- ts(Real_interest1$Real_interest_rate, start (1960,2))
```

```{r}
# Plot the Series
#ts_plot(y_t)
plot(y_t)
```

```{r}
#ts_plot(g_t)
plot(g_t)
```

```{r}
#ts_plot(r_t)
plot(r_t)
```


```{r echo = FALSE}

# Restrictions 

amat <- diag(3)
amat[2,1] <- NA
amat[3,1] <- NA
amat[3,2] <- NA
```


```{r echo = FALSE}

#Building the model

sv <- cbind(y_t,g_t,r_t)
sv1 <- sv[-1,]
sv2 <- sv1[-187,]
colnames(sv2) <- cbind("y_t", "g_t", "r_t")

lagselect <- VARselect(sv2, lag.max = 8, type = "both")

Model1 <- VAR(sv2, p = 3, season = NULL, type = "const")
SVARMod1 <- SVAR(Model1, Amat = amat, Bmat = NULL, hession = TRUE, estmethod = c("scoring", "direct"))
```

# IRFs

## Impulse Response of real GDP for each of the identified shocks

```{r}
SVARy_t <- irf(SVARMod1, impulse = "y_t", response = "y_t", n.ahead = 100)
plot(SVARy_t)
```

```{r}
SVARy_t <- irf(SVARMod1, impulse = "g_t", response = "y_t", n.ahead = 100)
plot(SVARy_t)
```

```{r}
SVARy_t <- irf(SVARMod1, impulse = "r_t", response = "y_t", n.ahead = 100)
plot(SVARy_t)
```

## Impulse Response of the real interest rate  for each of the identified shocks

```{r}
SVARr_t <- irf(SVARMod1, impulse = "y_t", response = "r_t", n.ahead = 100)
plot(SVARr_t)

```

```{r}
SVARr_t <- irf(SVARMod1, impulse = "g_t", response = "r_t", n.ahead = 100)
plot(SVARr_t)

```

```{r}
SVARr_t <- irf(SVARMod1, impulse = "r_t", response = "r_t", n.ahead = 100)
plot(SVARr_t)

```

## IRF of the government consumption to real GDP for each of the identified shocks

```{r}
SVARg_t <- irf(SVARMod1, impulse = "y_t", response = "g_t", n.ahead = 100)
plot(SVARg_t)
```

```{r}
SVARg_t <- irf(SVARMod1, impulse = "g_t", response = "g_t", n.ahead = 100)
plot(SVARg_t)
```

```{r}
SVARg_t <- irf(SVARMod1, impulse = "r_t", response = "g_t", n.ahead = 100)
plot(SVARg_t)
```


# Reference List

Du Plessis, S., Smit, B. and Sturzenegger, F., 2008. Identifying aggregate supply and demand shocks in South Africa. Journal of African economies, 17(5), pp.765-793.

# Appendix 

## Testing for Stationarity

```{r}
library(tseries)
adf.test(real_gdp1)

library(tseries)
adf.test(Real_interest1$Real_interest_rate)

library(tseries)
adf.test(g_g_not_s$Value)
```

